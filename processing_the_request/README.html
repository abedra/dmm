<!DOCTYPE HTML>
<html lang="en-US" >
    
    <head>
        
        <meta charset="UTF-8">
        <title>Processing the Request | Deterministic Memory Management on the JVM</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 1.0.2">
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    
    <link rel="next" href="../handling_the_request/README.html" />
    
    
    <link rel="prev" href="../an_example/README.html" />
    

        
    </head>
    <body>
        
        
<link rel="stylesheet" href="../gitbook/style.css">


        
    <div class="book"  data-level="2.1" data-basepath=".." data-revision="1410784702307">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
    	
    	
    	

        

        
    
        
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                        <i class="fa fa-check"></i>
                        
                         Introduction
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="1" data-path="the_problem/README.html">
            
                
                    <a href="../the_problem/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                         The Problem
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2" data-path="an_example/README.html">
            
                
                    <a href="../an_example/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                         An Example
                    </a>
                
            
            
            <ul class="articles">
                
    
        
        <li class="chapter active" data-level="2.1" data-path="processing_the_request/README.html">
            
                
                    <a href="../processing_the_request/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                         Processing the Request
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.2" data-path="handling_the_request/README.html">
            
                
                    <a href="../handling_the_request/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                         Handling the Request
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.3" data-path="generating_the_response/README.html">
            
                
                    <a href="../generating_the_response/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                         Generating the Response
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.4" data-path="encryptdecrypt/README.html">
            
                
                    <a href="../encryptdecrypt/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                         Encrypt/Decrypt
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="2.5" data-path="analyzing_the_heap/README.html">
            
                
                    <a href="../analyzing_the_heap/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.</b>
                        
                         Analyzing the Heap
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="3" data-path="byte_arrays/README.html">
            
                
                    <a href="../byte_arrays/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                         Byte Arrays
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="4" data-path="strings/README.html">
            
                
                    <a href="../strings/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                         Strings
                    </a>
                
            
            
        </li>
    
        
        <li class="chapter " data-level="5" data-path="going_off_heap/README.html">
            
                
                    <a href="../going_off_heap/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                         Going Off Heap
                    </a>
                
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="http://www.gitbook.io/" target="blank" class="gitbook-link">Published using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Toggle summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Toggle search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle font settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Toggle share dropdown"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">Twitter</button>
                <button type="button" data-sharing="google-plus" class="button">Google</button>
                <button type="button" data-sharing="facebook" class="button">Facebook</button>
                <button type="button" data-sharing="weibo" class="button">Weibo</button>
                <button type="button" data-sharing="instapaper" class="button">Instapaper</button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Share on Google Plus"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Share on Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Share on Twitter"><i class="fa fa-twitter"></i></a>
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" >Deterministic Memory Management on the JVM</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-gitbook_9">
                    
                        <h1 id="processing-the-request">Processing the Request</h1>
<p>For our example we will be processing <code>POST</code> requests on two different endpoints. As demonstrated
previously the endpoints will be <code>/encrypt</code> and <code>/decrypt</code>. Each request will have a post body
containing the payload to encrypt or decrypt. Once the action has been determined the operation
will be fulfilled and the response generated. We break the request down by HTTP method, path, and
action using the following code.</p>
<pre><code class="lang-java"><span class="hljs-keyword">import</span> java.util.Arrays;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HTTPRequest</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> String[] supportedMethods = {<span class="hljs-string">"GET"</span>, <span class="hljs-string">"POST"</span>};
    <span class="hljs-keyword">private</span> String method;
    <span class="hljs-keyword">private</span> String path;
    <span class="hljs-keyword">private</span> String action;
    <span class="hljs-keyword">private</span> String rawRequest;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">long</span> contentLength;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">byte</span>[] postData;

    <span class="hljs-keyword">public</span> <span class="hljs-title">HTTPRequest</span>(<span class="hljs-keyword">final</span> String rawRequest) {
        <span class="hljs-keyword">this</span>.rawRequest = rawRequest;
        <span class="hljs-keyword">this</span>.path = getPath();
        <span class="hljs-keyword">this</span>.action = getAction();
        <span class="hljs-keyword">this</span>.method = getMethod();
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title">getMethod</span>() {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.method == <span class="hljs-keyword">null</span>) {
            String meth = rawRequest.split(<span class="hljs-string">" "</span>)[<span class="hljs-number">0</span>];
            <span class="hljs-keyword">if</span> (Arrays.asList(supportedMethods).contains(meth)) {
                <span class="hljs-keyword">this</span>.method = meth;
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.method;
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">this</span>.method = <span class="hljs-string">""</span>;
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.method;
            }
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.method;
        }
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title">getPath</span>() {
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.path == <span class="hljs-keyword">null</span>) {
            <span class="hljs-keyword">this</span>.path = <span class="hljs-keyword">this</span>.rawRequest.split(<span class="hljs-string">" "</span>)[<span class="hljs-number">1</span>];
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.path;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.path;
        }
    }

    <span class="hljs-keyword">public</span> String <span class="hljs-title">getAction</span>() {
        String path = getPath();

        <span class="hljs-keyword">if</span> (path.equals(<span class="hljs-string">"/"</span>)) {
            <span class="hljs-keyword">this</span>.action = path;
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.action;
        }

        String[] parts = path.split(<span class="hljs-string">"/"</span>);

        <span class="hljs-keyword">this</span>.action = parts[parts.length - <span class="hljs-number">1</span>];
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.action;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">long</span> <span class="hljs-title">getContentLength</span>() {
        <span class="hljs-keyword">return</span> contentLength;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setContentLength</span>(<span class="hljs-keyword">final</span> <span class="hljs-keyword">long</span> contentLength) {
        <span class="hljs-keyword">this</span>.contentLength = contentLength;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setPostData</span>(<span class="hljs-keyword">final</span> <span class="hljs-keyword">byte</span>[] postData) {
        <span class="hljs-keyword">this</span>.postData = postData;
    }

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">byte</span>[] <span class="hljs-title">getPostData</span>() {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.postData;
    }
}
</code></pre>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../an_example/README.html" class="navigation navigation-prev " aria-label="Previous page: An Example"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../handling_the_request/README.html" class="navigation navigation-next " aria-label="Next page: Handling the Request"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="https://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-mathjax/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
